{"componentChunkName":"component---src-templates-blog-post-js","path":"/Blazor/[Blazor]Server App이랑 MariaDB 연결하기/","result":{"data":{"site":{"siteMetadata":{"title":"개발하는 곰돌이","author":"[Your Name]","siteUrl":"https://gatsby-starter-bee.netlify.com","comment":{"disqusShortName":"","utterances":"JaeYeopHan/gatsby-starter-bee"},"sponsor":{"buyMeACoffeeId":"jbee"}}},"markdownRemark":{"id":"fca301ab-55e6-50e1-999b-1e429103bfdd","excerpt":"Blazor Server App으로 프로젝트를 만들었을때 나오는 샘플 페이지에 DB연동을 해봤다. 아래 사진처럼 Fetch data 페이지에 들어가면 미리 넣어진 값을 보여주는 표가 나오는데, 이걸 MariaDB에 저장된 데이터로 채우기로 했다. Nuget 패키지 설치 도구 > NuGet 패키지 관리자 > 솔루션용 NuGet 패키지 관리에 들어간 후 사진에 보이는 패키지들을 설치해준다. 버전이 서로 안맞으면 에러가나는 경우가 있어서 5.0.x로 통일해주었다.   appsettings.json…","html":"<p>Blazor Server App으로 프로젝트를 만들었을때 나오는 샘플 페이지에 DB연동을 해봤다.</p>\n<p>아래 사진처럼 Fetch data 페이지에 들어가면 미리 넣어진 값을 보여주는 표가 나오는데, 이걸 MariaDB에 저장된 데이터로 채우기로 했다.</p>\n<ol>\n<li>\n<p>Nuget 패키지 설치</p>\n<p>도구 > NuGet 패키지 관리자 > 솔루션용 NuGet 패키지 관리에 들어간 후</p>\n<p>사진에 보이는 패키지들을 설치해준다.</p>\n<p><strong>버전이 서로 안맞으면 에러가나는 경우가 있어서 5.0.x로 통일해주었다.</strong></p>\n</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABJ0AAASdAHeZh94AAACbklEQVQ4y21Uy27bMBDURxRI/FAUvUVSEmXR1ltynMJB0Qa99ND22v//h+kuHRsJ2sOAFE2NZndm7QihkOcF+n5C2/a0jtjvG4zjjMOhRVUZNE1PZy3qurHY7Q50d6S7M+0NjNlDqRJFUcHxPB9pKlCW2hLzj1IqPDx4FtvtA1yX4UFkku5oKAK/zNC6tsjtmYaT69Ju9vuDJVQqRxhGWK3WWK832Gy2Fvf3K1T1AR2p4kradiD1F6IL2c7CCcIYQsibQn6RibZb1xLxnsEqq32PmsCtmKcThu5IQjo08wvG5Yzh+AWO/xggywQKItO6QpykN1UulZzQcxwnFjX1i3vaDwum+YSZMM1PMPSRHffWdNzDR3uZ1bFKJg2C4KaSf7/C7GoUMocUAkM/YJlG6KJA5PuIoxgRweFy27bDNM3k2kDuTujomd3nfrJBUkoIclGYHnkz0trROqDsF3iixCbJ4VKlvh9cXOaXDmSKMcYeum8OX+Gxy36E5Psf6K8/UX37BfnyA9XrbyRPr1jPr/jkRXA3GzgcC1bJpTLZ1ZT/QVL+RN0i0RQt00BTdlPaB0ojSTOKlYDD7jGhJDDhNS7vI3NFlmQoVYEdGfN8pB4uIxYagJkwDLMNv8ONZ3V1bWzjbYm08ofek10+nNsQs5vH44TT82cM42InyZBiOylrupznpZ2QoigpQpLMUOR0+I9KJlSkkIOvcol5WSg6i3Wcz8IwhJNS7UXJSS9uE3J3d/9W+tquV2SZslPB91LqV9N1NiFN04J5bGw4qCyXYxJFCQU5uyGOP4L/ABhMKChKx9MJ5/MLRW6yw8GEfwGQS6NPs+ZZdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"220314_01.png\"\n        title=\"220314_01.png\"\n        src=\"/static/e899fd9ff79356a1e79156b4c3e2fa7f/f3c12/220314_01.png\"\n        srcset=\"/static/e899fd9ff79356a1e79156b4c3e2fa7f/5a46d/220314_01.png 300w,\n/static/e899fd9ff79356a1e79156b4c3e2fa7f/0a47e/220314_01.png 600w,\n/static/e899fd9ff79356a1e79156b4c3e2fa7f/f3c12/220314_01.png 764w\"\n        sizes=\"(max-width: 764px) 100vw, 764px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVQ4y12Ty3KcMBRE+R57gGGGhwAhIQQC7ElW3rhcqSzy/9/QUYvA4Cy67uVRrXMfikSiYIsHCiEgRIu6lj42Id9VVU1Qfi9x97plOeL4GnS5pD5mSJIMXdcjKhOJqf+AGUcYM2KaFgzDBGvdptFh9BqGEXlebYa3Ihjtohnf93pA1MQ95uYDtZRQ/oS2VZBSh1iWAkUh/M/FP5L0IEvT2yEaXq93aG0Q5UkNLR8Y3QznVk8zY57XQEdiElo7QSkTxLKqsg5EJKbSNEPm26BJ2CYG790nxmXGuj682Vsoe13fg5Huh/BjeTLZy6ZIv+eB8B5XkPWCTvehVBJQUqrjWannMyn73h60NOEgWXYwlKnFD/UF6xwWT8dynVvgPCVbME3zYcyyXl5ivL4m38SeknojvFRoK4db/iznrL1PzEmxDef6TXzP4TwJzS+YaVsZEo1hVbaofWmcNHtIwt3wHGn47OFFoC0niKYNq9I03bHgzLnQXAmKFGezsyG/9z2nnA542N9QxsD4ZrPhXBezR7/QXafDUEh5Xuj/CfndT1lA5hZtp44J75OlEUlJyeu4E551NmSfI5kM+Dn9gRoGWH/leMW4d8bYcAWZb4foYEwKtoQlnq/ePry/Sq+w384E2XMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"220314_02.png\"\n        title=\"220314_02.png\"\n        src=\"/static/3a3b56cca37a7c3c70a508a8c3a20bbd/587b0/220314_02.png\"\n        srcset=\"/static/3a3b56cca37a7c3c70a508a8c3a20bbd/5a46d/220314_02.png 300w,\n/static/3a3b56cca37a7c3c70a508a8c3a20bbd/0a47e/220314_02.png 600w,\n/static/3a3b56cca37a7c3c70a508a8c3a20bbd/587b0/220314_02.png 970w\"\n        sizes=\"(max-width: 970px) 100vw, 970px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ol start=\"2\">\n<li>\n<p>appsettings.json의 “Logging” 아래에 ConnectionStrings 추가</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n \"Logging\": {\n   \"LogLevel\": {\n     \"Default\": \"Information\",\n     \"Microsoft\": \"Warning\",\n     \"Microsoft.Hosting.Lifetime\": \"Information\",\n   }\n },\n \"AllowedHosts\": \"*\",\n\n >>>>>추가&lt;&lt;&lt;&lt;&lt;\n \"ConnectionStrings\": {\n   \"Server=localhost;Port=포트번호;Database=데이터베이스명;Uid=사용자명;Pwd=암호;SslMode=None;\"\n }\n >>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n}</code></pre></div>\n</li>\n<li>\n<p>Startup.cs에 아래 코드 추가</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">>>>>>추가&lt;&lt;&lt;&lt;&lt;\nusing Microsoft.EntityFrameworkCore;\n>>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\npublic void ConfigureServices(IServiceCollection services)\n       {\n           .\n           .\n           >>>>>추가&lt;&lt;&lt;&lt;&lt;\n           var serverVersion = new MariaDbServerVersion(new Version(10, 6, 5));\n           services.AddDbContext&lt;AppDBContext>(item =>         item.UseMySql(Configuration.GetConnectionString(\"이름정하기\"), serverVersion));\n           >>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n       }</code></pre></div>\n</li>\n<li>\n<p>AppDBContext.cs 스크립트 생성 후 작성</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">>>>>>추가&lt;&lt;&lt;&lt;&lt;\nusing EF = Microsoft.EntityFrameworkCore;\n\nnamespace Test2.Data\n{\n   public class AppDBContext : EF.DbContext\n   {\n       public AppDBContext(EF.DbContextOptions&lt;AppDBContext> options) : base(options)\n       {\n\n       }\n\n       public EF.DbSet&lt;WeatherForecast> 테이블명 { get; set; }\n\n   }\n}\n>>>>>&lt;&lt;&lt;&lt;&lt;</code></pre></div>\n</li>\n<li>\n<p>WeatherForecast.cs에 내용 추가</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">using System;\n>>>>>추가&lt;&lt;&lt;&lt;&lt;\nusing System.ComponentModel.DataAnnotations;\n>>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\nnamespace Test2.Data\n{\n   public class WeatherForecast\n   {\n       >>>>>추가&lt;&lt;&lt;&lt;&lt; ... 기본키가 되는 항목 위에 꼭 [Key]를 붙여줘야한다. 안그럼 기본키가 없다는 오류가남.\n       [Key]\n       >>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n       public int Index { get; set; }\n\n       public DateTime Date { get; set; }\n\n       public int TemperatureC { get; set; }\n\n       public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);\n\n       public string Summary { get; set; }\n   }\n}</code></pre></div>\n</li>\n<li>\n<p>DB데이터를 불러올 스크립트에 아래 코드 추가. (내 샘플프로젝트에선 WeatherForecastService.cs)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">>>>>>추가&lt;&lt;&lt;&lt;&lt;\nusing System.Collections.Generic;\nusing Microsoft.EntityFrameworkCore;\n>>>>>>>&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\npublic class WeatherForecastService\n{\n   #region 프로퍼티\n   private readonly AppDBContext _appDBContext;\n   #endregion\n\n   #region Constructor\n   public WeatherForecastService(AppDBContext appDBContext)\n   {\n   _appDBContext = appDBContext;\n   }\n   #endregion\n\n   #region 날씨 조회하기\n   public async Task&lt;List&lt;WeatherForecast>> GetAllNewsAsync()\n   {\n   return await _appDBContext.테이블명.ToListAsync();\n   }\n   #endregion\n\n   #region 날씨 추가하기\n   public async Task&lt;bool> InsertWeatherAsync(WeatherForecast weather)\n   {\n   await _appDBContext.테이블명.AddAsync(weather);\n   await _appDBContext.SaveChangesAsync();\n   return true;\n   }\n   #endregion\n\n   #region 온도C로 날씨찾기\n   public async Task&lt;WeatherForecast> GetWeatherAsync(int tempC)\n   {\n   WeatherForecast weather = await _appDBContext.테이블명.FirstOrDefaultAsync(c => c.TemperatureC.Equals(tempC));\n   return weather;\n   }\n   #endregion\n\n   #region 날씨 업데이트하기\n   public async Task&lt;bool> UpdateWeatherAsync(WeatherForecast weather)\n   {\n   _appDBContext.테이블명.Update(weather);\n   await _appDBContext.SaveChangesAsync();\n   return true;\n   }\n   #endregion\n\n   #region 날씨 삭제하기\n   public async Task&lt;bool> DeleteWeatherAsync(WeatherForecast weather)\n   {\n   _appDBContext.Remove(weather);\n   await _appDBContext.SaveChangesAsync();\n   return true;\n   }\n   #endregion\n\n}</code></pre></div>\n</li>\n<li>\n<p>DB에 값넣기</p>\n<p>대충 두개만 넣어주었다.</p>\n</li>\n<li>\n<p>결과 확인</p>\n<p>잘 나온다!</p>\n</li>\n</ol>\n<p>참고</p>\n<p><a href=\"https://docs.microsoft.com/ko-kr/aspnet/core/blazor/blazor-server-ef-core?view=aspnetcore-6.0\">https://docs.microsoft.com/ko-kr/aspnet/core/blazor/blazor-server-ef-core?view=aspnetcore-6.0</a></p>\n<p><a href=\"https://www.c-sharpcorner.com/article/blazor-crud-app-using-entity-framework-core-in-net-5/\">https://www.c-sharpcorner.com/article/blazor-crud-app-using-entity-framework-core-in-net-5/</a></p>","frontmatter":{"title":"[Blazor]Server App이랑 MariaDB 연결하기","date":"March 14, 2022"}}},"pageContext":{"slug":"/Blazor/[Blazor]Server App이랑 MariaDB 연결하기/","previous":{"fields":{"slug":"/Blazor/에러 'Method 'Create' in type 'Microsoft/"},"frontmatter":{"title":"에러 Method Create in type Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitorFactory from assembly 해결법"}},"next":null}},"staticQueryHashes":["2486386679","3128451518"]}